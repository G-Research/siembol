apiVersion: v1
kind: ConfigMap
metadata:
  name: nginx-config
data:
  default.conf: |
    server {
        listen       8080;
        server_name  localhost;

        #access_log  /var/log/nginx/host.access.log  main;


        autoindex on;               # enable directory listing output
        autoindex_exact_size off;   # output file sizes rounded to kilobytes, megabytes, and gigabytes
        autoindex_localtime on;     # output local times in the directory


        location / {
            root   /usr/share/nginx/html;
            index  index.html index.htm;
        }
        location /data {
          root /;
          limit_except GET POST PUT { deny all; }
          client_max_body_size 50m; # 50 MB limit on file uploads
          client_body_buffer_size 128k;
          proxy_set_body $request_body_file;
          proxy_pass https://localhost:8080/data;
          proxy_redirect off;

        }

        #error_page  404              /404.html;

        # redirect server error pages to the static page /50x.html
        #
        error_page   500 502 503 504  /50x.html;
        location = /50x.html {
            root   /usr/share/nginx/html;
        }
    }

